<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>ГЛАВА 9 Выявление аномалий | Анализ временных рядов с помощью R</title>
  <meta name="description" content="Современные методы анализа временных рядов, реализованные в системе статистических вычислений R" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="ГЛАВА 9 Выявление аномалий | Анализ временных рядов с помощью R" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://ranalytics.github.io/tsa-with-r" />
  <meta property="og:image" content="https://ranalytics.github.io/tsa-with-rfigures/tsa_with_r_cover_cropped.png" />
  <meta property="og:description" content="Современные методы анализа временных рядов, реализованные в системе статистических вычислений R" />
  <meta name="github-repo" content="ranalytics/tsa-r" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="ГЛАВА 9 Выявление аномалий | Анализ временных рядов с помощью R" />
  
  <meta name="twitter:description" content="Современные методы анализа временных рядов, реализованные в системе статистических вычислений R" />
  <meta name="twitter:image" content="https://ranalytics.github.io/tsa-with-rfigures/tsa_with_r_cover_cropped.png" />

<meta name="author" content="Мастицкий С. Э." />


<meta name="date" content="2020-04-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-structural-changes.html"/>
<link rel="next" href="ch-ts-clustering-task.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Анализ временных рядов с помощью R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Аннотация</a></li>
<li class="chapter" data-level="" data-path="thanks.html"><a href="thanks.html"><i class="fa fa-check"></i>Благодарности</a></li>
<li class="chapter" data-level="" data-path="other-formats.html"><a href="other-formats.html"><i class="fa fa-check"></i>Дополнительные форматы книги</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Введение</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#what-this-book-is-about"><i class="fa fa-check"></i><b>1.1</b> О чем эта книга и чего в ней нет</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#who-this-book-is-for"><i class="fa fa-check"></i><b>1.2</b> Что ожидается от читателя</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#sec-main-concepts"><i class="fa fa-check"></i><b>1.3</b> Основные понятия</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#sec-data-format"><i class="fa fa-check"></i><b>1.4</b> Формат данных <code>tsibble</code></a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#sec-example-datasets"><i class="fa fa-check"></i><b>1.5</b> Данные, используемые в примерах</a><ul>
<li class="chapter" data-level="1.5.1" data-path="intro.html"><a href="intro.html#subsec-cryptos-price"><i class="fa fa-check"></i><b>1.5.1</b> Стоимость 22 криптовалют</a></li>
<li class="chapter" data-level="1.5.2" data-path="intro.html"><a href="intro.html#subsec-bitcoin-price"><i class="fa fa-check"></i><b>1.5.2</b> Стоимость биткоина</a></li>
<li class="chapter" data-level="1.5.3" data-path="intro.html"><a href="intro.html#subsec-share-price"><i class="fa fa-check"></i><b>1.5.3</b> Цена акций трех компаний</a></li>
<li class="chapter" data-level="1.5.4" data-path="intro.html"><a href="intro.html#subsec-hotel-price"><i class="fa fa-check"></i><b>1.5.4</b> Стоимость номеров в трех гостиницах</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>I Разведочный анализ данных</b></span></li>
<li class="chapter" data-level="2" data-path="ch-missing-values.html"><a href="ch-missing-values.html"><i class="fa fa-check"></i><b>2</b> Обработка пропущенных наблюдений</a></li>
<li class="chapter" data-level="3" data-path="ch-aggregation.html"><a href="ch-aggregation.html"><i class="fa fa-check"></i><b>3</b> Агрегирование наблюдений</a></li>
<li class="chapter" data-level="4" data-path="ch-visualisation.html"><a href="ch-visualisation.html"><i class="fa fa-check"></i><b>4</b> Визуализация временных рядов и их свойств</a></li>
<li class="chapter" data-level="5" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html"><i class="fa fa-check"></i><b>5</b> Извлечение признаков с помощью пакета <code>feasts</code></a><ul>
<li class="chapter" data-level="5.1" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#sec-features-function"><i class="fa fa-check"></i><b>5.1</b> Функция <code>features()</code></a></li>
<li class="chapter" data-level="5.2" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#sec-feasts-embedded-features"><i class="fa fa-check"></i><b>5.2</b> Встроенные функции для расчета признаков</a><ul>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#acf"><i class="fa fa-check"></i>acf</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#autocorrelation"><i class="fa fa-check"></i>autocorrelation</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#boxcox"><i class="fa fa-check"></i>boxcox</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#coefficients"><i class="fa fa-check"></i>coefficients</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#count"><i class="fa fa-check"></i>count</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#decomposition"><i class="fa fa-check"></i>decomposition</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#intermittent"><i class="fa fa-check"></i>intermittent</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#lumpiness"><i class="fa fa-check"></i>lumpiness</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#optimisation"><i class="fa fa-check"></i>optimisation</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#pacf"><i class="fa fa-check"></i>pacf</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#portmanteau"><i class="fa fa-check"></i>portmanteau</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#rle"><i class="fa fa-check"></i>rle</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#roll"><i class="fa fa-check"></i>roll</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#seasonal"><i class="fa fa-check"></i>seasonal</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#slide"><i class="fa fa-check"></i>slide</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#spectral"><i class="fa fa-check"></i>spectral</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#stability"><i class="fa fa-check"></i>stability</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#stl"><i class="fa fa-check"></i>stl</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#test"><i class="fa fa-check"></i>test</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#tile"><i class="fa fa-check"></i>tile</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#trend"><i class="fa fa-check"></i>trend</a></li>
<li class="chapter" data-level="" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#unitroot"><i class="fa fa-check"></i>unitroot</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ch-feature-extraction.html"><a href="ch-feature-extraction.html#sec-features-use"><i class="fa fa-check"></i><b>5.3</b> Примеры использования извлеченных признаков</a></li>
</ul></li>
<li class="part"><span><b>II Прогнозирование временных рядов</b></span></li>
<li class="chapter" data-level="6" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html"><i class="fa fa-check"></i><b>6</b> Пакет <code>prophet</code></a><ul>
<li class="chapter" data-level="6.1" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#sec-how-prophet-works"><i class="fa fa-check"></i><b>6.1</b> Методология</a></li>
<li class="chapter" data-level="6.2" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#sec-first-prophet-example"><i class="fa fa-check"></i><b>6.2</b> Первый простой пример</a></li>
<li class="chapter" data-level="6.3" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#sec-prophet-params"><i class="fa fa-check"></i><b>6.3</b> Функция <code>prophet()</code></a></li>
<li class="chapter" data-level="6.4" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#sec-prophet-changepoints"><i class="fa fa-check"></i><b>6.4</b> Точки излома тренда</a></li>
<li class="chapter" data-level="6.5" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#sec-prophet-holidays"><i class="fa fa-check"></i><b>6.5</b> Эффекты праздников и других важных событий</a><ul>
<li class="chapter" data-level="6.5.1" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#формат-представления"><i class="fa fa-check"></i><b>6.5.1</b> Формат представления</a></li>
<li class="chapter" data-level="6.5.2" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#встроенные-даты-праздников"><i class="fa fa-check"></i><b>6.5.2</b> Встроенные даты праздников</a></li>
<li class="chapter" data-level="6.5.3" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#регуляризация"><i class="fa fa-check"></i><b>6.5.3</b> Регуляризация</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#sec-prophet-seasonal-components"><i class="fa fa-check"></i><b>6.6</b> Сезонные компоненты</a><ul>
<li class="chapter" data-level="6.6.1" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#годовая-недельная-и-дневная-компоненты"><i class="fa fa-check"></i><b>6.6.1</b> Годовая, недельная и дневная компоненты</a></li>
<li class="chapter" data-level="6.6.2" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#пользовательские-сезонные-компоненты"><i class="fa fa-check"></i><b>6.6.2</b> Пользовательские сезонные компоненты</a></li>
<li class="chapter" data-level="6.6.3" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#условные-режимы-сезонности"><i class="fa fa-check"></i><b>6.6.3</b> Условные режимы сезонности</a></li>
<li class="chapter" data-level="6.6.4" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#регуляризация-сезонных-компонент"><i class="fa fa-check"></i><b>6.6.4</b> Регуляризация сезонных компонент</a></li>
<li class="chapter" data-level="6.6.5" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#аддитивная-и-мультипликативная-сезонности"><i class="fa fa-check"></i><b>6.6.5</b> Аддитивная и мультипликативная сезонности</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#sec-prophet-predictors"><i class="fa fa-check"></i><b>6.7</b> Модели с предикторами</a></li>
<li class="chapter" data-level="6.8" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#sec-prophet-optimal-model"><i class="fa fa-check"></i><b>6.8</b> Выбор оптимальной модели</a><ul>
<li class="chapter" data-level="6.8.1" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#subsec-shf"><i class="fa fa-check"></i><b>6.8.1</b> Метод имитированных исторических прогнозов</a></li>
<li class="chapter" data-level="6.8.2" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#выполнение-перекрестной-проверки"><i class="fa fa-check"></i><b>6.8.2</b> Выполнение перекрестной проверки</a></li>
<li class="chapter" data-level="6.8.3" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#subsec-perf-metric"><i class="fa fa-check"></i><b>6.8.3</b> Метрики качества модели</a></li>
<li class="chapter" data-level="6.8.4" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#пример-выбора-оптимальной-модели"><i class="fa fa-check"></i><b>6.8.4</b> Пример выбора оптимальной модели</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#sec-system-capacity"><i class="fa fa-check"></i><b>6.9</b> Моделирование емкости системы</a><ul>
<li class="chapter" data-level="6.9.1" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#тренд-с-насыщением"><i class="fa fa-check"></i><b>6.9.1</b> Тренд с насыщением</a></li>
<li class="chapter" data-level="6.9.2" data-path="ch-intro-to-prophet.html"><a href="ch-intro-to-prophet.html#примеры-моделей-с-насыщением-тренда"><i class="fa fa-check"></i><b>6.9.2</b> Примеры моделей с насыщением тренда</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="ch-intro-to-bsts.html"><a href="ch-intro-to-bsts.html"><i class="fa fa-check"></i><b>7</b> Пакет <code>bsts</code></a><ul>
<li class="chapter" data-level="7.1" data-path="ch-intro-to-bsts.html"><a href="ch-intro-to-bsts.html#sec-how-bsts-works"><i class="fa fa-check"></i><b>7.1</b> Методология</a></li>
<li class="chapter" data-level="7.2" data-path="ch-intro-to-bsts.html"><a href="ch-intro-to-bsts.html#sec-bsts-function"><i class="fa fa-check"></i><b>7.2</b> Функция <code>bsts()</code></a></li>
<li class="chapter" data-level="7.3" data-path="ch-intro-to-bsts.html"><a href="ch-intro-to-bsts.html#sec-bsts-add-functions"><i class="fa fa-check"></i><b>7.3</b> Спецификация компонент модели</a></li>
<li class="chapter" data-level="7.4" data-path="ch-intro-to-bsts.html"><a href="ch-intro-to-bsts.html#sec-bsts-model-examples"><i class="fa fa-check"></i><b>7.4</b> Примеры моделей без предикторов</a></li>
<li class="chapter" data-level="7.5" data-path="ch-intro-to-bsts.html"><a href="ch-intro-to-bsts.html#sec-bsts-models-with-regressors"><i class="fa fa-check"></i><b>7.5</b> Модели с предикторами</a></li>
<li class="chapter" data-level="7.6" data-path="ch-intro-to-bsts.html"><a href="ch-intro-to-bsts.html#sec-bsts-optimal-model"><i class="fa fa-check"></i><b>7.6</b> Выбор оптимальной модели</a></li>
</ul></li>
<li class="part"><span><b>III Структурные изменения и аномалии во временных рядах</b></span></li>
<li class="chapter" data-level="8" data-path="ch-structural-changes.html"><a href="ch-structural-changes.html"><i class="fa fa-check"></i><b>8</b> Выявление структурных изменений</a><ul>
<li class="chapter" data-level="8.1" data-path="ch-structural-changes.html"><a href="ch-structural-changes.html#метод-edivisive-with-medians-edm"><i class="fa fa-check"></i><b>8.1</b> Метод “E–Divisive with Medians” (EDM)</a></li>
<li class="chapter" data-level="8.2" data-path="ch-structural-changes.html"><a href="ch-structural-changes.html#функция-breakout"><i class="fa fa-check"></i><b>8.2</b> Функция <code>breakout()</code></a></li>
<li class="chapter" data-level="8.3" data-path="ch-structural-changes.html"><a href="ch-structural-changes.html#примеры-использования-функции-breakout"><i class="fa fa-check"></i><b>8.3</b> Примеры использования функции <code>breakout()</code></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="ch-anomaly-detection.html"><a href="ch-anomaly-detection.html"><i class="fa fa-check"></i><b>9</b> Выявление аномалий</a><ul>
<li class="chapter" data-level="9.1" data-path="ch-anomaly-detection.html"><a href="ch-anomaly-detection.html#автоматическое-обнаружение-аномалий"><i class="fa fa-check"></i><b>9.1</b> Автоматическое обнаружение аномалий</a></li>
<li class="chapter" data-level="9.2" data-path="ch-anomaly-detection.html"><a href="ch-anomaly-detection.html#ручная-настройка-параметров-для-обнаружения-аномалий"><i class="fa fa-check"></i><b>9.2</b> Ручная настройка параметров для обнаружения аномалий</a></li>
<li class="chapter" data-level="9.3" data-path="ch-anomaly-detection.html"><a href="ch-anomaly-detection.html#одновременный-анализ-нескольких-временных-рядов"><i class="fa fa-check"></i><b>9.3</b> Одновременный анализ нескольких временных рядов</a></li>
</ul></li>
<li class="part"><span><b>IV Кластеризация</b></span></li>
<li class="chapter" data-level="10" data-path="ch-ts-clustering-task.html"><a href="ch-ts-clustering-task.html"><i class="fa fa-check"></i><b>10</b> Задача кластеризации временных рядов</a></li>
<li class="chapter" data-level="11" data-path="ch-ts-clustering-by-raw-data.html"><a href="ch-ts-clustering-by-raw-data.html"><i class="fa fa-check"></i><b>11</b> Кластеризация по исходным данным</a><ul>
<li class="chapter" data-level="11.1" data-path="ch-ts-clustering-by-raw-data.html"><a href="ch-ts-clustering-by-raw-data.html#dtw-расстояние"><i class="fa fa-check"></i><b>11.1</b> DTW-расстояние</a></li>
<li class="chapter" data-level="11.2" data-path="ch-ts-clustering-by-raw-data.html"><a href="ch-ts-clustering-by-raw-data.html#пакет-dtwclust"><i class="fa fa-check"></i><b>11.2</b> Пакет <code>dtwclust</code></a></li>
<li class="chapter" data-level="11.3" data-path="ch-ts-clustering-by-raw-data.html"><a href="ch-ts-clustering-by-raw-data.html#пример-кластеризации-с-использованием-dtwрасстояния"><i class="fa fa-check"></i><b>11.3</b> Пример кластеризации с использованием DTW–расстояния</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="ch-features-based-clustering.html"><a href="ch-features-based-clustering.html"><i class="fa fa-check"></i><b>12</b> Кластеризация по описательным признакам</a></li>
<li class="chapter" data-level="13" data-path="ch-model-based-clustering.html"><a href="ch-model-based-clustering.html"><i class="fa fa-check"></i><b>13</b> Кластеризация по результатам подгонки моделей</a></li>
<li class="chapter" data-level="14" data-path="ch-literature.html"><a href="ch-literature.html"><i class="fa fa-check"></i><b>14</b> Литература</a></li>
<li class="divider"></li>
<li><a href="http://mastitsky.com">
© 2020, Мастицкий С. Э.</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Анализ временных рядов с помощью R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch-anomaly-detection" class="section level1">
<h1><span class="header-section-number">ГЛАВА 9</span> Выявление аномалий</h1>
<p>Необходимость обнаружения необычных наблюдений (выбросов, или аномалий) во временных рядах часто возникает в таких ситуациях, как мониторинг состояния оборудования, отслеживание неожиданных колебаний на рынке ценных бумаг, учет показателей состояния здоровья пациентов и т.д. В этой главе мы рассмотрим один из инструментов для решения подобных задач — пакет <code>anomalize</code>. Для описания основ работы с этим пакетом воспользуемся данными по стоимости гостиничных номеров из таблицы <code>hotels</code> (подразд. <a href="intro.html#subsec-hotel-price">1.5.4</a>).</p>
<div id="автоматическое-обнаружение-аномалий" class="section level2">
<h2><span class="header-section-number">9.1</span> Автоматическое обнаружение аномалий</h2>
<p>Для начала попробуем обнаружить необычные наблюдения во временном ряду одной из гостиниц (напрмиер, с идентификатором <code>prop_id = 13252</code>). Для этого к таблице с данными (класса <code>tibble</code>, <code>tibbletime</code> или <code>tsibble</code>) необходимо последовательно применить команды с участием следующих функций из пакета <code>anomalize</code>:</p>
<ul>
<li><code>time_decompose()</code> — выполняет декомпозицию временного ряда на отдельные составляющие (сезонную, тренд и остатки; см. гл. <a href="ch-visualisation.html#ch-visualisation">4</a>);</li>
<li><code>anomalize()</code> — применяет к остаткам один из двух реализованных в пакете методов выявления аномалий (см. ниже);</li>
<li><code>time_recompose()</code> — восстанавливает исходный временной ряд, параллельно вычисляя верхнюю и нижнюю границы диапазона, в который входят “нормальные” наблюдения.</li>
</ul>
<p>Получаемый в итоге объект имеет следующую структуру:</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb172-1" title="1"><span class="kw">require</span>(anomalize)</a>
<a class="sourceLine" id="cb172-2" title="2"></a>
<a class="sourceLine" id="cb172-3" title="3">result_<span class="dv">13252</span> &lt;-<span class="st"> </span>hotels <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb172-4" title="4"><span class="st">  </span><span class="kw">filter</span>(prop_id <span class="op">==</span><span class="st"> </span><span class="dv">13252</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb172-5" title="5"><span class="st">  </span><span class="kw">time_decompose</span>(price_usd, <span class="dt">merge =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb172-6" title="6"><span class="st">  </span><span class="kw">anomalize</span>(remainder) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb172-7" title="7"><span class="st">  </span><span class="kw">time_recompose</span>()</a></code></pre></div>
<p>Разберемся подробнее, что именно произошло в результате выполнения приведенных выше команд:</p>
<ul>
<li>Результатом применения <code>time_decompose()</code> к исходным данным стал расчет четырех столбцов: <code>observed</code> (исходные наблюдения моделируемой переменной), <code>season</code> (сезонная составляющая временного ряда), <code>trend</code> (тренд) и <code>remainder</code> (остатки). Параметр <code>merge = TRUE</code> привел к тому, что эти новые столбцы были добавлены к исходным данным.</li>
<li>Функция <code>anomalize()</code> была применена к столбцу <code>remainder</code> и рассчитала три новых столбца — <code>remainder_l1</code> и <code>remainder_l2</code> (нижняя и верхняя границы, за пределами которых наблюдения считаются аномалиями), а также индикаторную переменную <code>anomaly</code>, которая принимает значение <code>"No"</code>, если наблюдение не является выбросом, и <code>"Yes"</code> если является.</li>
<li>Функция <code>time_recompose()</code> восстанавила исходный временной ряд с использованием значений из <code>season</code>, <code>trend</code>, <code>remainder_l1</code> и <code>remainder_l2</code> и попутно рассчитала два новых столбца: <code>recomposed_l1</code> и <code>recomposed_l2</code>, которые соответствуют верхней и нижней границам диапазона “нормальных” наблюдений.</li>
</ul>
<p>Суть всех этих вычислений станет понятнее, если мы представим результаты графически. Функция <code>plot_anomaly_decomposition()</code> изображает компоненты временного ряда, рассчитываемые функцией <code>time_decompose()</code>. На получаемом графике аномалии показаны в виде обведенных кружком красных точек (рис. <a href="ch-anomaly-detection.html#fig:auto-anomalies-13252">9.1</a>):</p>

<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb173-1" title="1">result_<span class="dv">13252</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plot_anomaly_decomposition</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:auto-anomalies-13252"></span>
<img src="time_series_ru_files/figure-html/auto-anomalies-13252-1.png" alt="Результат автоматического обнаружения аномалий во временном ряду, выполненного с помощью пакета anomalize" width="100%" />
<p class="caption">
РИСУНОК 9.1: Результат автоматического обнаружения аномалий во временном ряду, выполненного с помощью пакета <code>anomalize</code>
</p>
</div>
<p>Еще одна функция — <code>plot_anomalies()</code> — позволяет отдельно изобразить исходный временной ряд и обнаруженные в нем необычные наблюдения (рис. <a href="ch-anomaly-detection.html#fig:auto-anomalies-13252-more">9.2</a>):</p>

<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb174-1" title="1">result_<span class="dv">13252</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">plot_anomalies</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:auto-anomalies-13252-more"></span>
<img src="time_series_ru_files/figure-html/auto-anomalies-13252-more-1.png" alt="Аномальные наблюдения, автоматически обнаруженные во временном ряду с помощью пакета anomalize" width="100%" />
<p class="caption">
РИСУНОК 9.2: Аномальные наблюдения, автоматически обнаруженные во временном ряду с помощью пакета <code>anomalize</code>
</p>
</div>
<p>Поскольку <code>plot_anomalies()</code> возвращает графический объект класса <code>ggplot</code>, то при желании мы можем легко добавить к нему другие <code>ggplot</code>–элементы обычным в таких случаях способом. Добавим, например, линию, последовательно соединяющую все точки (рис. <a href="ch-anomaly-detection.html#fig:anomalize-ggplot">9.3</a>):</p>

<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb175-1" title="1">result_<span class="dv">13252</span> <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb175-2" title="2"><span class="st">  </span><span class="kw">plot_anomalies</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb175-3" title="3"><span class="st">  </span><span class="kw">geom_line</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:anomalize-ggplot"></span>
<img src="time_series_ru_files/figure-html/anomalize-ggplot-1.png" alt="Пример сочетания функции plot_anomalies() из пакета anomalize и функции geom_line() из пакета ggplot2" width="100%" />
<p class="caption">
РИСУНОК 9.3: Пример сочетания функции <code>plot_anomalies()</code> из пакета <code>anomalize</code> и функции <code>geom_line()</code> из пакета <code>ggplot2</code>
</p>
</div>
</div>
<div id="ручная-настройка-параметров-для-обнаружения-аномалий" class="section level2">
<h2><span class="header-section-number">9.2</span> Ручная настройка параметров для обнаружения аномалий</h2>
<p>При создании объекта <code>result_13252</code> все вычисления были выполнены с использованием настроек, заданных в пакете <code>anomalize</code> по умолчанию. Часто для получения приемлемого результата этого будет достаточно. Однако, в зависимости от свойств анализируемого временного ряда, иногда потребуется более тонкая настройка соответствующих параметров.</p>
<p>Рассмотрим сначала параметры функции <code>time_decompose()</code>, которая выполняет разложение ряда на отдельные компоненты. Результат работы этой функции в значительной мере зависит от значений следующих ее аргументов:</p>
<ul>
<li><code>frequency</code> — определяет “частоту” сезонной компоненты, т.е. число наблюдений, входящих в один сезонный цикл (например, для дневных данных этот аргумент по умолчанию будет равен <code>"1 week"</code>, т.е. одной неделе);</li>
<li><code>trend</code> — определяет число наблюдений в отдельных отрезках временного ряда, используемых для расчета тренда (например, для дневных данных по умолчанию <code>trend = "3 months"</code>, т.е. три месяцам);</li>
<li><code>method</code> — метод, используемый для разложения ряда на компоненты. У этого аргумента есть два возможных значения: <code>"stl"</code> (принято по умолчанию) и <code>"twitter"</code>. STL — это классический метод разложения временных рядов на компоненты, в основе которого лежит сглаживание данных по методу нелинейной локальной регрессии (гл. <a href="ch-visualisation.html#ch-visualisation">4</a>). Метод<code>"twitter"</code> — более новый и, как следует из его названия, был предложен исследователями из компании Twitter <span class="citation">(Vallis, Hochenbaum, and Kejariwal <a href="ch-literature.html#ref-vallis_et_al_2014" role="doc-biblioref">2014</a>)</span>. В рамках этого метода тренд оценивается путем вычисления медиан в пределах отдельных интервалов времени, на которые разбивает исходный ряд (их длина определяется параметром <code>trend</code> — см. выше).</li>
</ul>
<p>По умолчанию аргументы <code>frequency</code> и <code>trend</code> принимают значения <code>"auto"</code> (автоматический режим). В этом случае для выбора конкретных подходящих ситуации значений <code>frequency</code> и <code>trend</code> функция <code>time_decompose()</code> обращается к другой функции — <code>get_time_scale_template()</code>, которая возвращает “справочник” типичных значений:</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb176-1" title="1"><span class="kw">get_time_scale_template</span>()</a></code></pre></div>
<pre><code>## # A tibble: 8 x 3
##   time_scale frequency trend   
##   &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;   
## 1 second     1 hour    12 hours
## 2 minute     1 day     14 days 
## 3 hour       1 day     1 month 
## 4 day        1 week    3 months
## 5 week       1 quarter 1 year  
## 6 month      1 year    5 years 
## 7 quarter    1 year    10 years
## 8 year       5 years   30 years</code></pre>
<p>Видим, например, что в случае с данными, где промежуток между наблюдениями выражается в секундах, параметры <code>frequency</code> и <code>trend</code> будут выражаться в часах и по умолчанию составят <code>"1 hour"</code> (1 час) и <code>"12 hours"</code> (12 часов) соответственно. Следует отметить однако, что в зависимости от интервала между наблюдениями и длины самого временного ряда, конкретные выбранные программой значения <code>frequency</code> и <code>trend</code> необязательно окажутся равными приведенным выше значениям из “справочника”. Именно это произошло выше при создании объекта <code>result_13252</code> (<code>frequency = 2 hours</code>, <code>trend = 61 hours</code>). Помимо строковых значений (<code>"1 hour"</code>, <code>"2 days"</code>, <code>"2 weeks"</code> и т.д.) обоим параметрам можно присваивать и числовые значения (см. ниже) — часто это оказывается более удобным подходом. Отметим также, что “шаблонные” значения параметров <code>frequency</code> и <code>trend</code> можно изменить глобально с помощью функции <code>set_time_scale_template()</code> (пример не приводится).</p>
<p>Для отмены автоматического выбора значений <code>frequency</code> и <code>trend</code> достаточно указать желаемые значения при вызове функции <code>time_decompose()</code>. В приведенном ниже примере мы присвоим этим параметрам значения 2 и 6 (часов) соответственно:</p>

<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb178-1" title="1">hotels <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb178-2" title="2"><span class="st">  </span><span class="kw">filter</span>(prop_id <span class="op">==</span><span class="st"> </span><span class="dv">13252</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb178-3" title="3"><span class="st">  </span><span class="kw">time_decompose</span>(price_usd, <span class="dt">frequency =</span> <span class="dv">2</span>, <span class="dt">trend =</span> <span class="dv">6</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb178-4" title="4"><span class="st">  </span><span class="kw">anomalize</span>(remainder) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb178-5" title="5"><span class="st">  </span><span class="kw">time_recompose</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb178-6" title="6"><span class="st">  </span><span class="kw">plot_anomaly_decomposition</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:manual-anomalies-13252"></span>
<img src="time_series_ru_files/figure-html/manual-anomalies-13252-1.png" alt="Результат обнаружения аномалий во временном ряду, выполненного с помощью пользовательских настроек функции time_decompose()" width="100%" />
<p class="caption">
РИСУНОК 9.4: Результат обнаружения аномалий во временном ряду, выполненного с помощью пользовательских настроек функции <code>time_decompose()</code>
</p>
</div>
<p>Как видно на рис. <a href="ch-anomaly-detection.html#fig:manual-anomalies-13252">9.4</a>, уменьшение параметров <code>frequency</code> и <code>trend</code> привело к классификации большего количества наблюдений как аномалий. Это обычный результат в таких случаях, обусловленный переобучением Loess–модели тренда (обратите внимание на то, какой извилистой стала кривая тренда на рис. <a href="ch-anomaly-detection.html#fig:manual-anomalies-13252">9.4</a> по сравнению с рис. <a href="ch-anomaly-detection.html#fig:auto-anomalies-13252">9.1</a>). В отличие от Loess, второй метод разложения временных рядов — <code>"twitter"</code> — более устойчив к локальным колебаниям и поэтому при тех же значениях <code>frequency</code> и <code>trend</code> обычно относит к аномалиям меньше наблюдений. Это легко проверить (сравните рис. <a href="ch-anomaly-detection.html#fig:manual-anomalies-13252">9.4</a> и рис. <a href="ch-anomaly-detection.html#fig:twitter-anomalies-13252">9.5</a>):</p>

<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb179-1" title="1">hotels <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb179-2" title="2"><span class="st">  </span><span class="kw">filter</span>(prop_id <span class="op">==</span><span class="st"> </span><span class="dv">13252</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb179-3" title="3"><span class="st">  </span><span class="kw">time_decompose</span>(price_usd, <span class="dt">frequency =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb179-4" title="4">                 <span class="dt">trend =</span> <span class="dv">6</span>, <span class="dt">method =</span> <span class="st">&quot;twitter&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb179-5" title="5"><span class="st">  </span><span class="kw">anomalize</span>(remainder) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb179-6" title="6"><span class="st">  </span><span class="kw">time_recompose</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb179-7" title="7"><span class="st">  </span><span class="kw">plot_anomaly_decomposition</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:twitter-anomalies-13252"></span>
<img src="time_series_ru_files/figure-html/twitter-anomalies-13252-1.png" alt="Результат обнаружения аномалий во временном ряду, выполненного по методу twitter" width="100%" />
<p class="caption">
РИСУНОК 9.5: Результат обнаружения аномалий во временном ряду, выполненного по методу <code>twitter</code>
</p>
</div>
<p>Функция <code>anomalize</code> позволяет выбрать один из двух методов выявления аномальных наблюдений, а также настроить чувствительность этих методов. Для этого служат следующие аргументы функции:</p>
<ul>
<li><code>method</code> — принимает два возможных значения в соответствии с названием метода обнаружения аномалий: <code>"iqr"</code> (принято по умолчанию) и <code>"gesd"</code>. Метод IQR (от “interquartile range”, т.е. “интерквартильный размах”) работает быстрее, но не так точен, как GESD (Generalized Extreme Studentized Deviate test).</li>
<li><code>alpha</code> — контролирует ширину диапазона “нормальных” значений (по умолчанию равен 0.05). Чем меньше этот параметр, тем шире диапазон значений, рассматриваемых как “нормальные”, и тем меньше наблюдений будут классифицированы как аномальные.</li>
<li><code>max_anoms</code> — максимальная доля наблюдений, которые позволено отнести к аномалиям (0.2 по умолчанию, т.е. 20%).</li>
</ul>
<p>Рассмотрим влияние параметра <code>alpha</code>, снизив его значение с принятого по умолчанию 0.05 до 0.025. При этом оставим параметры <code>frequency</code> и <code>trend</code> функции <code>time_decompose()</code> такими же, как на рис. <a href="ch-anomaly-detection.html#fig:manual-anomalies-13252">9.4</a>:</p>

<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb180-1" title="1">hotels <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb180-2" title="2"><span class="st">  </span><span class="kw">filter</span>(prop_id <span class="op">==</span><span class="st"> </span><span class="dv">13252</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb180-3" title="3"><span class="st">  </span><span class="kw">time_decompose</span>(price_usd, </a>
<a class="sourceLine" id="cb180-4" title="4">                 <span class="dt">frequency =</span> <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb180-5" title="5">                 <span class="dt">trend =</span> <span class="dv">6</span>, </a>
<a class="sourceLine" id="cb180-6" title="6">                 <span class="dt">method =</span> <span class="st">&quot;twitter&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb180-7" title="7"><span class="st">  </span><span class="kw">anomalize</span>(remainder, <span class="dt">alpha =</span> <span class="fl">0.025</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb180-8" title="8"><span class="st">  </span><span class="kw">time_recompose</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb180-9" title="9"><span class="st">  </span><span class="kw">plot_anomaly_decomposition</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:alpha-anomalies-13252"></span>
<img src="time_series_ru_files/figure-html/alpha-anomalies-13252-1.png" alt="Результат обнаружения аномалий во временном ряду, выполненного с пониженным значением параметра alpha функции anomalize()" width="100%" />
<p class="caption">
РИСУНОК 9.6: Результат обнаружения аномалий во временном ряду, выполненного с пониженным значением параметра <code>alpha</code> функции <code>anomalize()</code>
</p>
</div>
<p>Как видно на рис. <a href="ch-anomaly-detection.html#fig:auto-anomalies-13252">9.1</a>, несмотря на все еще имеющее место переобучение Loess–модели тренда, к классу аномальных было отнесено намного меньшее количество наблюдений. Аналогичного эффекта можно было бы добиться также путем снижения параметра <code>max_anoms</code> функции <code>anomalize()</code> (пример не приводится).</p>
</div>
<div id="одновременный-анализ-нескольких-временных-рядов" class="section level2">
<h2><span class="header-section-number">9.3</span> Одновременный анализ нескольких временных рядов</h2>
<p>Отличительной особенностью пакета <code>anomalize</code> является возможность параллельно анализировать несколько временных рядов на наличие аномалий. Для этого достаточно в таблице с данными иметь группирующую переменную, которая идентифицирует отдельные ряды. В нашем примере с ценами на гостиничные номера такой одновременный анализ выглядел бы следующим образом (параметрам всех функций здесь присвоены их автоматически выбранные значения; обратите внимание на аргумент <code>time_recompose = TRUE</code> функции <code>plot_anomalies()</code> — он позволяет включить изображение на графике диапазона, в который входят “нормальные” наблюдения):</p>

<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb181-1" title="1">hotels <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb181-2" title="2"><span class="st">  </span><span class="kw">group_by_key</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb181-3" title="3"><span class="st">  </span><span class="kw">time_decompose</span>(price_usd) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb181-4" title="4"><span class="st">  </span><span class="kw">anomalize</span>(remainder) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb181-5" title="5"><span class="st">  </span><span class="kw">time_recompose</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb181-6" title="6"><span class="st">  </span><span class="kw">plot_anomalies</span>(<span class="dt">time_recomposed =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:anomalize-many-ts"></span>
<img src="time_series_ru_files/figure-html/anomalize-many-ts-1.png" alt="Результат обнаружения аномалий во временном ряду, выполненного с пониженным значением параметра alpha функции anomalize()" width="100%" />
<p class="caption">
РИСУНОК 9.7: Результат обнаружения аномалий во временном ряду, выполненного с пониженным значением параметра <code>alpha</code> функции <code>anomalize()</code>
</p>
</div>
<p>Стоит подчеркнуть, что в пакете <code>anomalize</code> нет возможности настраивать параметры функций для отдельных рядов при таком параллельном анализе. Поэтому параллельный анализ имеет смысл выполнять только на рядах, охватывающих примерно одинаковый период, имеющих одинаковую периодичность регистрации наблюдений и, конечно же, описывающих динамику той же переменной. В нашем примере с ценами на гостиничные номера все эти условия выполняются.</p>
<p>На этом мы завершим рассмотрение основных возможностей пакета <code>anomalize</code> для обнаружения необычных наблюдений во временных рядах. Дополнительные <a href="https://cran.r-project.org/web/packages/anomalize/vignettes/anomalize_quick_start_guide.html">примеры работы</a> с этим пакетом, а также более подробное описание лежащих в его основе <a href="https://cran.r-project.org/web/packages/anomalize/vignettes/anomalize_methods.html">методов</a>, можно найти в официальной документации.</p>

</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="ch-structural-changes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-ts-clustering-task.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": true,
"weibo": false,
"instapaper": false,
"vk": true,
"all": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["time_series_ru.epub"],
"toc": {
"collapse": "subsection"
},
"search": false,
"info": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
